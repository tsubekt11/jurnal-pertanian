<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Jurnal Harian Pertanian</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box}
body{font-family:Arial;margin:0;background:#f4f7f4}
header{background:#2f7d32;color:#fff;padding:16px;text-align:center}

.hidden{display:none}

.card{
  background:#fff;
  margin:12px;
  padding:12px;
  border-radius:10px;
  box-shadow:0 2px 6px rgba(0,0,0,.1)
}

label{font-weight:bold;margin-top:8px;display:block}
input,textarea,select,button{
  width:100%;
  padding:8px;
  margin-top:4px
}

button{
  background:#2f7d32;
  color:#fff;
  border:none;
  border-radius:6px;
  margin-top:12px
}

.header-info{
  font-size:14px;
  margin-top:6px;
  line-height:1.5
}

.link{color:#b2ffb2;text-decoration:underline}
</style>
</head>

<body>

<header>
  <h2>ğŸŒ¾ Jurnal Harian Pertanian</h2>
  <div id="headerInfo" class="header-info">
    Data awal musim belum diisi
  </div>
  <button id="btnEditAwal" class="hidden" onclick="editAwal()">âœï¸ Ubah Data Awal</button>
</header>

<!-- DATA AWAL MUSIM -->
<div class="card" id="dataAwalBox">
  <h3>ğŸ“Œ Data Awal Musim</h3>

  <label>Nama Komoditi</label>
  <input id="komoditi">

  <label>Jumlah Tanaman (batang)</label>
  <input id="jumlah" type="number">

  <label>Luas Lahan (Ha)</label>
  <input id="luas" type="number" step="0.01">

  <label>Nama Desa</label>
  <input id="desa">

  <label>Lokasi Lahan (Link Google Maps)</label>
  <input id="lokasi">

  <label>Tanggal Mulai Olah Lahan (Hari ke-1)</label>
  <input type="date" id="olah">

  <label>Tanggal Tanam</label>
  <input type="date" id="tanam">

  <button onclick="simpanAwal()">ğŸ’¾ Simpan Data Awal</button>
</div>

<!-- CATATAN TANGGAL -->
<div class="card">
  <h3>ğŸ“… Tanggal Catatan</h3>
  <input type="date" id="tanggalCatatan">
</div>

<!-- CATATAN KEGIATAN -->
<div class="card">
  <h3>ğŸ““ Catatan Kegiatan</h3>
  <textarea id="kegiatan" placeholder="Tuliskan kegiatan hari ini..."></textarea>
  <button onclick="simpanKegiatan()">ğŸ’¾ Simpan Kegiatan</button>
</div>

<!-- CATATAN BIAYA -->
<div class="card">
  <h3>ğŸ’° Catatan Biaya & Modal</h3>

  <label>Jenis</label>
  <select id="jenis">
    <option>Belanja</option>
    <option>Upah</option>
    <option>Modal</option>
  </select>

  <label>Keterangan</label>
  <input id="ket">

  <label>Jumlah (Rp)</label>
  <input id="jumlahUang">

  <button onclick="simpanBiaya()">ğŸ’¾ Simpan</button>
</div>

<div class="card" id="riwayat"></div>
<div class="card" id="ringkasan"></div>

<script>
/* ================= UTIL ================= */
function formatHari(t){
  return new Date(t).toLocaleDateString("id-ID",{
    weekday:"long",day:"numeric",month:"long",year:"numeric"
  });
}

/* ================= DATA AWAL ================= */
function simpanAwal(){
  const awal={
    komoditi:komoditi.value,
    jumlah:jumlah.value,
    luas:luas.value,
    desa:desa.value,
    lokasi:lokasi.value,
    olah:olah.value,
    tanam:tanam.value
  };
  localStorage.setItem("awal",JSON.stringify(awal));
  tampilHeader();
  dataAwalBox.classList.add("hidden");
  btnEditAwal.classList.remove("hidden");
}

function editAwal(){
  dataAwalBox.classList.remove("hidden");
  window.scrollTo({top:0,behavior:"smooth"});
}

function tampilHeader(){
  const a=JSON.parse(localStorage.getItem("awal"));
  if(!a) return;

  headerInfo.innerHTML=`
    <b>${a.komoditi}</b> â€” ${a.jumlah} batang | ${a.luas} Ha<br>
    Desa ${a.desa}<br>
    ğŸŒ± Olah Lahan: ${formatHari(a.olah)}<br>
    ğŸŒ¾ Tanam: ${formatHari(a.tanam)}<br>
    ğŸ“ <a class="link" href="${a.lokasi}" target="_blank">Lihat Lokasi</a>
  `;
}

/* ================= KEGIATAN ================= */
function simpanKegiatan(){
  const data=JSON.parse(localStorage.getItem("kegiatan"))||[];
  data.push({
    tanggal:tanggalCatatan.value,
    teks:kegiatan.value
  });
  localStorage.setItem("kegiatan",JSON.stringify(data));
  tampilRiwayat();
}

/* ================= BIAYA ================= */
function simpanBiaya(){
  const data=JSON.parse(localStorage.getItem("biaya"))||[];
  data.push({
    tanggal:tanggalCatatan.value,
    jenis:jenis.value,
    ket:ket.value,
    total:+jumlahUang.value
  });
  localStorage.setItem("biaya",JSON.stringify(data));
  tampilRiwayat();
}

/* ================= RIWAYAT ================= */
function tampilRiwayat(){
  const k=JSON.parse(localStorage.getItem("kegiatan"))||[];
  const b=JSON.parse(localStorage.getItem("biaya"))||[];
  let modal=0,keluar=0;

  riwayat.innerHTML="<h3>ğŸ“– Riwayat</h3>";

  [...k,...b].sort((a,b)=>new Date(a.tanggal)-new Date(b.tanggal))
  .forEach(x=>{
    if(x.jenis=="Modal") modal+=x.total;
    if(x.jenis=="Belanja"||x.jenis=="Upah") keluar+=x.total;

    riwayat.innerHTML+=`
    <div class="card">
      <b>${formatHari(x.tanggal)}</b><br>
      ${x.teks||""}
      ${x.jenis?`<br>${x.jenis} â€” Rp ${x.total.toLocaleString("id-ID")}`:""}
    </div>`;
  });

  ringkasan.innerHTML=`
    <h3>ğŸ“Š Ringkasan</h3>
    Modal Masuk: Rp ${modal.toLocaleString("id-ID")}<br>
    Total Biaya: Rp ${keluar.toLocaleString("id-ID")}<br>
    <b>Sisa Modal: Rp ${(modal-keluar).toLocaleString("id-ID")}</b>
  `;
}

/* ================= INIT ================= */
if(localStorage.getItem("awal")){
  dataAwalBox.classList.add("hidden");
  btnEditAwal.classList.remove("hidden");
  tampilHeader();
}
tampilRiwayat();
</script>

</body>
</html>
