<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Jurnal Harian Pertanian</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Arial;background:#f4f7f4;margin:0}
header{background:#2f7d32;color:#fff;padding:14px;text-align:center}
.card{background:#fff;margin:12px;padding:12px;border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,.1)}
input,textarea,select,button{width:100%;padding:8px;margin-top:6px}
button{background:#2f7d32;color:#fff;border:none;border-radius:6px}
.item{border:1px dashed #ccc;padding:8px;margin-top:8px;border-radius:6px}
.small{font-size:13px;color:#555}
</style>
</head>

<body>
<header>
<h2>ðŸŒ¾ Jurnal Harian Pertanian</h2>
<p>Catatan kegiatan, biaya, dan modal</p>
</header>

<!-- DATA AWAL -->
<div class="card">
<b>ðŸ“Œ Data Awal Musim</b>
<label>Tanggal Mulai Olah Lahan (Hari ke-1)</label>
<input type="date" id="olahLahan">
<label>Tanggal Tanam</label>
<input type="date" id="tanggalTanam">
<button onclick="simpanDataAwal()">Simpan Data Awal</button>
</div>

<!-- CATATAN KEGIATAN -->
<div class="card">
<b>ðŸ““ Catatan Kegiatan</b>
<label>Tanggal</label>
<input type="date" id="tanggalKegiatan">
<label>Kegiatan</label>
<textarea id="kegiatan"></textarea>
<button onclick="simpanKegiatan()">ðŸ’¾ Simpan Kegiatan</button>
</div>

<!-- CATATAN BIAYA & MODAL -->
<div class="card">
<b>ðŸ’° Catatan Biaya & Modal</b>

<label>Tanggal</label>
<input type="date" id="tanggalBiaya">

<label>Jenis</label>
<select id="jenisBiaya" onchange="toggleBelanja()">
<option value="Belanja">Belanja</option>
<option value="Upah">Upah</option>
<option value="Modal">Modal Masuk</option>
</select>

<div id="belanjaBox"></div>
<button onclick="tambahItem()">âž• Tambah Item Belanja</button>

<label>Keterangan (Upah / Modal)</label>
<input type="text" id="keterangan">

<label>Jumlah (Rp)</label>
<input type="number" id="jumlah">

<button onclick="simpanBiaya()">ðŸ’¾ Simpan</button>
</div>

<!-- RINGKASAN -->
<div class="card" id="ringkasan"></div>

<!-- RIWAYAT -->
<div class="card" id="riwayat"></div>

<script>
/* UTIL */
function formatTanggal(t){
  const hari=["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];
  const d=new Date(t);
  return hari[d.getDay()]+", "+d.toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"});
}

/* DATA AWAL */
function simpanDataAwal(){
localStorage.setItem("olah",olahLahan.value);
localStorage.setItem("tanam",tanggalTanam.value);
alert("Data awal tersimpan");
}
olahLahan.value=localStorage.getItem("olah")||"";
tanggalTanam.value=localStorage.getItem("tanam")||"";

/* KEGIATAN */
function simpanKegiatan(){
let data=JSON.parse(localStorage.getItem("kegiatan"))||[];
data.push({tanggal:tanggalKegiatan.value,teks:kegiatan.value});
localStorage.setItem("kegiatan",JSON.stringify(data));
tampil();
}

/* BELANJA */
function tambahItem(){
belanjaBox.innerHTML+=`
<div class="item">
<input placeholder="Nama Barang">
<input type="number" placeholder="Jumlah">
<input type="number" placeholder="Harga Satuan">
</div>`;
}
toggleBelanja();
function toggleBelanja(){
belanjaBox.style.display=jenisBiaya.value=="Belanja"?"block":"none";
}

/* SIMPAN BIAYA / MODAL */
function simpanBiaya(){
let data=JSON.parse(localStorage.getItem("biaya"))||[];
let jenis=jenisBiaya.value;
let total=0,items=[];
if(jenis=="Belanja"){
document.querySelectorAll(".item").forEach(i=>{
let n=i.children[0].value;
let q=+i.children[1].value;
let h=+i.children[2].value;
if(n&&q&&h){items.push({n,q,h});total+=q*h;}
});
}else{
total=+jumlah.value;
}
data.push({tanggal:tanggalBiaya.value,jenis,keterangan:keterangan.value,total,items});
localStorage.setItem("biaya",JSON.stringify(data));
tampil();
}

/* TAMPILKAN */
function tampil(){
let keg=JSON.parse(localStorage.getItem("kegiatan"))||[];
let bio=JSON.parse(localStorage.getItem("biaya"))||[];
let gabung=[...keg.map(k=>({...k,tipe:"kegiatan"})),...bio.map(b=>({...b,tipe:"biaya"}))];
gabung.sort((a,b)=>new Date(a.tanggal)-new Date(b.tanggal));

let modal=0,keluar=0;
riwayat.innerHTML="<h3>ðŸ“– Riwayat</h3>";
gabung.forEach(x=>{
if(x.tipe=="biaya"){
if(x.jenis=="Modal") modal+=x.total;
else keluar+=x.total;
}
riwayat.innerHTML+=`
<div class="card">
<b>${formatTanggal(x.tanggal)}</b><br>
${x.teks||""}
${x.items?x.items.map(i=>`<div class="small">${i.n} ${i.q} x Rp${i.h}</div>`).join(""):""}
${x.total?"<b>Rp "+x.total.toLocaleString()+"</b>":""}
</div>`;
});
ringkasan.innerHTML=`
<b>ðŸ“Š Ringkasan Modal</b><br>
Modal Masuk: Rp ${modal.toLocaleString()}<br>
Total Biaya: Rp ${keluar.toLocaleString()}<br>
<b>Sisa Modal: Rp ${(modal-keluar).toLocaleString()}</b>`;
}
tampil();
</script>
</body>
</html>
