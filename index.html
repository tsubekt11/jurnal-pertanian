<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jurnal Harian Pertanian</title>

<style>
*{box-sizing:border-box}
body{
  font-family:Arial, Helvetica, sans-serif;
  background:#f4f7f4;
  margin:0;
  padding:12px;
}
.card{
  background:#fff;
  padding:14px;
  margin-bottom:14px;
  border-radius:10px;
  box-shadow:0 2px 6px rgba(0,0,0,.08);
}
.card h3{
  margin:0 0 10px 0;
}
.row{
  display:flex;
  align-items:center;
  gap:10px;
  margin-bottom:8px;
}
input,button{
  padding:8px;
  font-size:15px;
}
button{
  background:#2f7d32;
  color:#fff;
  border:none;
  border-radius:6px;
}
.tgl{
  width:150px;
  text-align:right;
}
.tgl-info{
  flex:1;
  font-size:18px;
  font-weight:bold;
}
hr{margin:10px 0}

/* BELANJA */
.item{
  margin-top:10px;
}
.item-title{
  font-weight:bold;
}
.item-sub{
  text-align:right;
  font-size:14px;
}
.item-input{
  display:grid;
  grid-template-columns: 1fr 50px 110px;
  gap:6px;
  margin-top:6px;
}
.qty{text-align:center}
.harga{text-align:right}
.total{
  text-align:right;
  font-weight:bold;
}
</style>
</head>

<body>

<!-- DATA AWAL -->
<div class="card">
<h3>ðŸ“Œ Data Awal Musim</h3>

<div class="row">
  <input type="date" id="olah" class="tgl" onchange="updateHari()">
  <div class="tgl-info" id="infoOlah"></div>
</div>

<div class="row">
  <input type="date" id="tanam" class="tgl" onchange="updateHari()">
  <div class="tgl-info" id="infoTanam"></div>
</div>

<button onclick="simpanAwal()">Simpan Data Awal</button>
</div>

<!-- BIAYA -->
<div class="card">
<h3>ðŸ’° Catatan Biaya & Modal</h3>

<b>Tanggal</b>
<input type="date" id="tglBiaya">

<br><br>
<button onclick="tambahItem()">+ Tambah Item Belanja</button>

<div id="belanja"></div>

<hr>
<div class="total" id="grandTotal">Grand Total: Rp 0</div>

<button onclick="simpanBelanja()">Simpan</button>
</div>

<!-- RIWAYAT -->
<div class="card">
<h3>ðŸ“œ Riwayat</h3>
<div id="riwayat">Belum ada data.</div>
</div>

<script>
let items=[];

function formatHari(t){
  return new Date(t).toLocaleDateString("id-ID",{
    weekday:"long", day:"numeric", month:"long", year:"numeric"
  });
}

function updateHari(){
  if(olah.value) infoOlah.innerText = formatHari(olah.value);
  if(tanam.value) infoTanam.innerText = formatHari(tanam.value);
}

function simpanAwal(){
  localStorage.setItem("olah", olah.value);
  localStorage.setItem("tanam", tanam.value);
  alert("Data awal tersimpan Alhamdulillah ðŸ¤²");
}

olah.value = localStorage.getItem("olah") || "";
tanam.value = localStorage.getItem("tanam") || "";
updateHari();

function tambahItem(){
  items.push({nama:"", qty:1, harga:0});
  render();
}

function render(){
  let html="";
  let total=0;

  items.forEach((it,i)=>{
    let sub = it.qty * it.harga;
    total += sub;

    html += `
    <div class="item">
      <div class="item-title">${i+1}. ${it.nama || "Nama Barang"}</div>
      <div class="item-sub">${it.qty} x ${it.harga.toLocaleString()} = <b>${sub.toLocaleString()}</b></div>

      <div class="item-input">
        <input placeholder="Nama Barang" value="${it.nama}"
          onchange="items[${i}].nama=this.value">
        <input class="qty" type="number" value="${it.qty}"
          onchange="items[${i}].qty=this.value;render()">
        <input class="harga" type="number" value="${it.harga}"
          onchange="items[${i}].harga=this.value;render()">
      </div>
    </div>`;
  });

  belanja.innerHTML = html || "<i>Belum ada item belanja.</i>";
  grandTotal.innerText = "Grand Total: Rp " + total.toLocaleString();
}

function simpanBelanja(){
  if(items.length===0){
    alert("Belum ada item belanja");
    return;
  }
  riwayat.innerHTML = "Belanja tersimpan Alhamdulillah ðŸ¤²";
  items=[];
  render();
}
</script>

</body>
</html>
