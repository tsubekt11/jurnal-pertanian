<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Jurnal Harian Pertanian</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body{
      font-family: Arial, Helvetica, sans-serif;
      margin:0;
      background:#f4f7f4;
    }
    header{
      background:#2f7d32;
      color:#fff;
      padding:14px;
      text-align:center;
    }
    .card{
      background:#fff;
      margin:12px;
      padding:12px;
      border-radius:10px;
      box-shadow:0 2px 6px rgba(0,0,0,.08);
    }
    input, textarea, select, button{
      width:100%;
      padding:8px;
      margin-top:4px;
      box-sizing:border-box;
    }
    button{
      background:#2f7d32;
      color:#fff;
      border:none;
      border-radius:6px;
      font-size:15px;
      margin-top:10px;
    }
  </style>
</head>

<body>
<header>
  <h2>ğŸŒ¾ Jurnal Harian Pertanian</h2>
  <p>Catatan kegiatan & perawatan lahan</p>
</header>

<div class="card">
  <b>ğŸ“Œ Data Awal Musim</b><br><br>
  <label>Tanggal Mulai Olah Lahan (Hari ke-1)</label>
  <input type="date" id="olahLahan">
  <label>Tanggal Tanam</label>
  <input type="date" id="tanggalTanam">
  <button onclick="simpanDataAwal()">Simpan Data Awal</button>
</div>

<div class="card">
  <b>ğŸ““ Catatan Kegiatan</b><br><br>
  <label>Tanggal Kegiatan</label>
  <input type="date" id="tanggal">
  <label>Kegiatan</label>
  <textarea id="kegiatan" rows="4"></textarea>
  <button onclick="simpan()">ğŸ’¾ Simpan Catatan</button>
</div>

<div class="card" id="riwayat"></div>

<div class="card">
  <b>ğŸ’° Catatan Biaya & Upah</b><br><br>
  <label>Tanggal</label>
  <input type="date" id="tanggalBiaya">
  <label>Jenis</label>
  <select id="jenisBiaya">
    <option value="Belanja">Belanja</option>
    <option value="Upah">Upah</option>
  </select>
  <label>Keterangan</label>
  <input type="text" id="keteranganBiaya">
  <label>Jumlah (Rp)</label>
  <input type="number" id="jumlahBiaya">
  <button onclick="simpanBiaya()">ğŸ’¾ Simpan Biaya</button>
</div>

<div class="card" id="riwayatBiaya"></div>
<div class="card" id="totalBiaya"></div>

<script>
// ================= DATA AWAL =================
function simpanDataAwal(){
  const olah = document.getElementById('olahLahan').value;
  const tanam = document.getElementById('tanggalTanam').value;
  if(!olah || !tanam){ alert("Lengkapi data awal ğŸ™"); return; }
  localStorage.setItem('olah_lahan', olah);
  localStorage.setItem('tanggal_tanam', tanam);
  alert("Data awal tersimpan ğŸŒ±");
}

function hitungHari(t1, t2){
  return Math.floor((new Date(t2) - new Date(t1)) / 86400000) + 1;
}

// ================= KEGIATAN =================
function simpan(){
  const tanggal = document.getElementById('tanggal').value;
  const kegiatan = document.getElementById('kegiatan').value;
  const olah = localStorage.getItem('olah_lahan');
  const tanam = localStorage.getItem('tanggal_tanam');
  if(!olah || !tanam){ alert("Data awal belum ada"); return; }

  const data = JSON.parse(localStorage.getItem('jurnal_harian')) || [];
  data.push({
    tanggal,
    hariKe: hitungHari(olah, tanggal),
    hst: hitungHari(tanam, tanggal) - 1,
    kegiatan
  });

  localStorage.setItem('jurnal_harian', JSON.stringify(data));
  tampilkanData();
}

function tampilkanData(){
  const box = document.getElementById('riwayat');
  const data = JSON.parse(localStorage.getItem('jurnal_harian')) || [];
  data.sort((a,b)=>new Date(a.tanggal)-new Date(b.tanggal));
  box.innerHTML = "<h3>ğŸ“– Riwayat Catatan</h3>";
  data.forEach(d=>{
    box.innerHTML += `<div class="card">
      <b>Hari ke-${d.hariKe}</b><br>ğŸ“… ${d.tanggal}<br>ğŸŒ± HST: ${d.hst}<br>ğŸ“ ${d.kegiatan}
    </div>`;
  });
}

// ================= BIAYA =================
function simpanBiaya(){
  const tanggal = document.getElementById('tanggalBiaya').value;
  const jenis = document.getElementById('jenisBiaya').value;
  const ket = document.getElementById('keteranganBiaya').value;
  const jumlah = parseInt(document.getElementById('jumlahBiaya').value);
  if(!tanggal || !ket || !jumlah){ alert("Lengkapi data biaya"); return; }

  const data = JSON.parse(localStorage.getItem('jurnal_biaya')) || [];
  data.push({tanggal, jenis, ket, jumlah});
  localStorage.setItem('jurnal_biaya', JSON.stringify(data));
  tampilkanBiaya();
}

function tampilkanBiaya(){
  const box = document.getElementById('riwayatBiaya');
  const totalBox = document.getElementById('totalBiaya');
  const data = JSON.parse(localStorage.getItem('jurnal_biaya')) || [];
  data.sort((a,b)=>new Date(a.tanggal)-new Date(b.tanggal));

  let total = 0;
  box.innerHTML = "<h3>ğŸ“’ Riwayat Biaya</h3>";
  data.forEach(d=>{
    total += d.jumlah;
    box.innerHTML += `<div class="card">
      ğŸ“… ${d.tanggal}<br>ğŸ’¼ ${d.jenis}<br>ğŸ“ ${d.ket}<br>ğŸ’° Rp ${d.jumlah.toLocaleString()}
    </div>`;
  });
  totalBox.innerHTML = `<h3>ğŸ“Š Total Modal</h3><h2>Rp ${total.toLocaleString()}</h2>`;
}

tampilkanData();
tampilkanBiaya();
</script>

</body>
</html>
